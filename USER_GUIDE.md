# 🤖 自動補卡程式 - 使用指南

> **一鍵自動化補卡系統，專為 MayoHR 系統設計**

## 📋 功能概述

- ✅ **自動登入**：支援三欄位登入（公司代碼、帳號、密碼）
- ✅ **智慧補卡**：自動處理上班/下班/全日補卡
- ✅ **彈窗處理**：自動處理重複補卡警告
- ✅ **批次處理**：支援多筆補卡記錄一次性處理
- ✅ **錯誤處理**：詳細日誌記錄，方便問題排查

## 🚀 快速開始

### 1. 環境需求
- macOS 系統
- Google Chrome 瀏覽器
- Node.js (建議 v16 以上)

### 2. 安裝步驟
```bash
# 1. 安裝依賴
npm install

# 2. 編譯程式
npm run build
```

### 3. 設定個人資訊
編輯 `data/user-info.txt` 檔案：

```
登入資訊：
    公司代碼：TNLMG
    登入帳號：你的帳號
    密碼：你的密碼

補卡日期：
    2025/06/04	上班未打卡		
    2025/06/03	上班未打卡 / 下班未打卡	
    2025/06/02	下班未打卡
```

**補卡日期格式說明：**
- `yyyy/mm/dd 上班未打卡` - 只補上班打卡
- `yyyy/mm/dd 下班未打卡` - 只補下班打卡  
- `yyyy/mm/dd 上班未打卡 / 下班未打卡` - 補全日打卡

### 4. 執行程式
```bash
# 執行自動補卡
npm start
```

## 📊 執行過程

程式會自動：
1. 🔐 **登入系統** - 使用你設定的帳號密碼
2. 📝 **填寫表單** - 自動選擇類型、日期、地點
3. ✉️ **送簽處理** - 自動提交並處理回應
4. 🔄 **循環執行** - 處理所有補卡記錄
5. ✅ **完成報告** - 顯示處理結果

## 📁 檔案結構

```
auto-re-check/
├── data/user-info.txt          # 個人設定檔案 (你需要編輯)
├── src/integrated-main-v2.ts   # 主程式
├── logs/                       # 執行日誌
├── screenshots/                # 執行截圖
└── archive/                    # 封存檔案
```

## 🔧 故障排除

### 常見問題

**Q: 程式顯示 Chrome 路徑錯誤？**
A: 確認 Chrome 安裝在 `/Applications/Google Chrome.app/`

**Q: 登入失敗？**
A: 檢查 `data/user-info.txt` 中的帳號密碼是否正確

**Q: 補卡失敗？**
A: 查看 `logs/` 資料夾中的最新日誌檔案

### 日誌查看
```bash
# 查看最新執行日誌
ls -t logs/ | head -1 | xargs -I {} cat logs/{}
```

### 重新安裝
```bash
# 清理並重新安裝
rm -rf node_modules package-lock.json
npm install
npm run build
```

## ⚠️ 注意事項

- **資料安全**：請妥善保管 `data/user-info.txt` 中的密碼
- **執行時間**：避免在系統維護時間執行
- **重複補卡**：程式會自動處理重複補卡警告
- **錯誤終止**：任何填表或送簽錯誤都會立即終止程式

## 📞 技術支援

如遇問題，請提供：
1. 錯誤訊息截圖
2. 最新的日誌檔案 (`logs/` 資料夾)
3. 執行環境資訊 (`node --version`, `which chrome`)

---

**🎯 設計理念：一次設定，全自動執行，讓補卡變得輕鬆簡單！**
