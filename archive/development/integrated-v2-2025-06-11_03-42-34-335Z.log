[2025-06-11T03:42:34.340Z] [INFO ] === 開始整合版自動補卡程式 v2 ===
[2025-06-11T03:42:34.340Z] [INFO ] 載入配置: 5 筆補卡記錄，展開為 9 個任務
[2025-06-11T03:42:34.340Z] [INFO ] >>> Phase 1: 開始登入流程
[2025-06-11T03:42:34.340Z] [INFO ] 正在啟動瀏覽器...
[2025-06-11T03:42:35.920Z] [OK   ] 瀏覽器啟動成功
[2025-06-11T03:42:35.921Z] [INFO ] 開始登入流程
[2025-06-11T03:42:37.740Z] [INFO ] 已處理登入彈出視窗
[2025-06-11T03:42:40.854Z] [INFO ] 登入表單填寫完成
[2025-06-11T03:42:41.684Z] [OK   ] 登入成功
[2025-06-11T03:42:41.836Z] [INFO ] 截圖已保存: screenshots/after_login_success_1749613361684.png
[2025-06-11T03:42:41.837Z] [INFO ] 正在導航到表單申請頁面
[2025-06-11T03:42:41.960Z] [INFO ] 截圖已保存: screenshots/before_form_application_search_1749613361837.png
[2025-06-11T03:42:43.963Z] [INFO ] 導航前 URL | Context: {
  "url": "https://apollo.mayohr.com/tube"
}
[2025-06-11T03:42:45.482Z] [OK   ] 成功導航到表單申請頁面
[2025-06-11T03:42:45.482Z] [OK   ] >>> Phase 1: 登入流程完成
[2025-06-11T03:42:45.482Z] [INFO ] >>> Phase 2: 開始補卡流程
[2025-06-11T03:42:45.483Z] [INFO ] 開始處理 9 個補卡任務
[2025-06-11T03:42:45.483Z] [INFO ] [1/9] 處理任務: 2025/06/10 下班打卡
[2025-06-11T03:42:52.949Z] [INFO ] 填寫表單: 2025/06/10 下班打卡
[2025-06-11T03:42:53.162Z] [INFO ] 截圖已保存: screenshots/form_loaded_1749613372951.png
[2025-06-11T03:42:53.168Z] [INFO ] 開始填寫類型欄位
[2025-06-11T03:42:53.168Z] [INFO ] 選擇補卡類型: 下班
[2025-06-11T03:42:53.178Z] [INFO ] 成功使用 select 方法選擇類型: 下班 (value=2)
[2025-06-11T03:42:53.669Z] [INFO ] 截圖已保存: screenshots/after_type_selection_1749613373479.png
[2025-06-11T03:42:53.670Z] [INFO ] 開始填寫日期/時間欄位
[2025-06-11T03:42:53.670Z] [INFO ] 設定日期時間: 2025/06/10
[2025-06-11T03:42:53.672Z] [INFO ] 點擊日曆按鈕開啟日期選擇器
[2025-06-11T03:42:54.208Z] [INFO ] 目標日期: 2025年6月10日
[2025-06-11T03:42:54.221Z] [INFO ] 當前年份: null, 目標年份: 2025
[2025-06-11T03:42:57.964Z] [INFO ] 成功設定日期: 2025/06/10
[2025-06-11T03:42:58.463Z] [INFO ] 截圖已保存: screenshots/after_datetime_selection_1749613378266.png
[2025-06-11T03:42:58.463Z] [INFO ] 開始填寫地點欄位
[2025-06-11T03:42:58.463Z] [INFO ] 選擇地點: TNLMG
[2025-06-11T03:42:58.468Z] [INFO ] 成功使用 select 方法選擇地點: TNLMG (value=518ee0c2-a787-40a6-bb94-5a081250e896)
[2025-06-11T03:42:58.955Z] [INFO ] 截圖已保存: screenshots/after_location_selection_1749613378769.png
[2025-06-11T03:42:58.956Z] [INFO ] 表單填寫完成
[2025-06-11T03:42:58.956Z] [INFO ] 準備送簽表單
[2025-06-11T03:42:58.987Z] [INFO ] 點擊送簽按鈕
[2025-06-11T03:42:58.988Z] [INFO ] 處理送簽結果...
[2025-06-11T03:43:02.001Z] [INFO ] 無確認對話框需要處理
[2025-06-11T03:43:04.002Z] [OK   ] 表單分頁已自動關閉，送簽成功
[2025-06-11T03:43:04.004Z] [OK   ] 表單送簽完成
[2025-06-11T03:43:04.005Z] [INFO ] 表單分頁已自動關閉
[2025-06-11T03:43:04.038Z] [INFO ] 已切換回主頁面
[2025-06-11T03:43:04.039Z] [OK   ] 任務 2025/06/10 下班打卡 完成
[2025-06-11T03:43:04.039Z] [INFO ] [2/9] 處理任務: 2025/06/09 上班打卡
[2025-06-11T03:43:24.047Z] [ERROR] 任務 2025/06/09 上班打卡 失敗: Waiting for selector `a[href*="javascript:void(0)"][data-formkind="TNLMG9.FORM.1001"]` failed: Waiting failed: 10000ms exceeded
[2025-06-11T03:43:24.048Z] [ERROR] 程式執行失敗: Waiting for selector `a[href*="javascript:void(0)"][data-formkind="TNLMG9.FORM.1001"]` failed: Waiting failed: 10000ms exceeded
[2025-06-11T03:43:24.049Z] [ERROR] 錯誤堆疊 | Context: {
  "stack": "TimeoutError: Waiting for selector `a[href*=\"javascript:void(0)\"][data-formkind=\"TNLMG9.FORM.1001\"]` failed: Waiting failed: 10000ms exceeded\n    at new WaitTask (/Users/tnl-loso/Desktop/auto-re-check/node_modules/puppeteer-core/lib/cjs/puppeteer/common/WaitTask.js:50:34)\n    at IsolatedWorld.waitForFunction (/Users/tnl-loso/Desktop/auto-re-check/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Realm.js:25:26)\n    at PQueryHandler.waitFor (/Users/tnl-loso/Desktop/auto-re-check/node_modules/puppeteer-core/lib/cjs/puppeteer/common/QueryHandler.js:170:95)\n    at async CdpFrame.waitForSelector (/Users/tnl-loso/Desktop/auto-re-check/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Frame.js:494:21)\n    at async CdpPage.waitForSelector (/Users/tnl-loso/Desktop/auto-re-check/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Page.js:1351:20)\n    at async IntegratedAutoAttendanceSystemV2.clickForgetPunchLink (/Users/tnl-loso/Desktop/auto-re-check/dist/integrated-main-v2.js:454:29)\n    at async IntegratedAutoAttendanceSystemV2.processSingleAttendanceTask (/Users/tnl-loso/Desktop/auto-re-check/dist/integrated-main-v2.js:405:9)\n    at async IntegratedAutoAttendanceSystemV2.processAllAttendanceTasks (/Users/tnl-loso/Desktop/auto-re-check/dist/integrated-main-v2.js:391:17)\n    at async IntegratedAutoAttendanceSystemV2.run (/Users/tnl-loso/Desktop/auto-re-check/dist/integrated-main-v2.js:804:13)\n    at async main (/Users/tnl-loso/Desktop/auto-re-check/dist/integrated-main-v2.js:834:9)"
}
[2025-06-11T03:43:24.159Z] [INFO ] 瀏覽器已關閉
