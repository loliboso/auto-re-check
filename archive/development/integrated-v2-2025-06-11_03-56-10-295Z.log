[2025-06-11T03:56:10.296Z] [INFO ] === 開始整合版自動補卡程式 v2 ===
[2025-06-11T03:56:10.297Z] [INFO ] 載入配置: 5 筆補卡記錄，展開為 9 個任務
[2025-06-11T03:56:10.297Z] [INFO ] >>> Phase 1: 開始登入流程
[2025-06-11T03:56:10.297Z] [INFO ] 正在啟動瀏覽器...
[2025-06-11T03:56:12.151Z] [OK   ] 瀏覽器啟動成功
[2025-06-11T03:56:12.152Z] [INFO ] 開始登入流程
[2025-06-11T03:56:14.040Z] [INFO ] 已處理登入彈出視窗
[2025-06-11T03:56:16.901Z] [INFO ] 登入表單填寫完成
[2025-06-11T03:56:17.730Z] [OK   ] 登入成功
[2025-06-11T03:56:17.915Z] [INFO ] 截圖已保存: screenshots/after_login_success_1749614177731.png
[2025-06-11T03:56:17.916Z] [INFO ] 正在導航到表單申請頁面
[2025-06-11T03:56:18.038Z] [INFO ] 截圖已保存: screenshots/before_form_application_search_1749614177916.png
[2025-06-11T03:56:20.041Z] [INFO ] 導航前 URL | Context: {
  "url": "https://apollo.mayohr.com/tube"
}
[2025-06-11T03:56:21.798Z] [OK   ] 成功導航到表單申請頁面
[2025-06-11T03:56:21.799Z] [OK   ] >>> Phase 1: 登入流程完成
[2025-06-11T03:56:21.799Z] [INFO ] >>> Phase 2: 開始補卡流程
[2025-06-11T03:56:21.799Z] [INFO ] 開始處理 9 個補卡任務
[2025-06-11T03:56:21.799Z] [INFO ] [1/9] 處理任務: 2025/06/10 下班打卡
[2025-06-11T03:56:21.799Z] [INFO ] 檢查當前頁面 | Context: {
  "url": "https://flow.mayohr.com/GAIA/bpm/applyform?moduleType=apply&companyCode=TNLMG&muid=b154c3d6-7337-4af6-aff2-49cf849cde9b"
}
[2025-06-11T03:56:22.801Z] [INFO ] 尋找忘打卡申請單連結...
[2025-06-11T03:56:22.841Z] [INFO ] 成功點擊忘打卡申請單連結
[2025-06-11T03:56:28.860Z] [INFO ] 填寫表單: 2025/06/10 下班打卡
[2025-06-11T03:56:29.049Z] [INFO ] 截圖已保存: screenshots/form_loaded_1749614188861.png
[2025-06-11T03:56:29.054Z] [INFO ] 開始填寫日期/時間欄位
[2025-06-11T03:56:29.054Z] [INFO ] 設定日期時間: 2025/06/10
[2025-06-11T03:56:29.056Z] [INFO ] 點擊日曆按鈕開啟日期選擇器
[2025-06-11T03:56:29.607Z] [INFO ] 目標日期: 2025年6月10日
[2025-06-11T03:56:29.613Z] [INFO ] 當前年份: null, 目標年份: 2025
[2025-06-11T03:56:33.277Z] [INFO ] 成功設定日期: 2025/06/10
[2025-06-11T03:56:33.763Z] [INFO ] 截圖已保存: screenshots/after_datetime_selection_1749614193581.png
[2025-06-11T03:56:33.764Z] [INFO ] 開始填寫類型欄位
[2025-06-11T03:56:33.764Z] [INFO ] 選擇補卡類型: 下班
[2025-06-11T03:56:33.772Z] [INFO ] 成功使用 select 方法選擇類型: 下班 (value=2)
[2025-06-11T03:56:34.280Z] [INFO ] 截圖已保存: screenshots/after_type_selection_1749614194079.png
[2025-06-11T03:56:34.280Z] [INFO ] 開始填寫地點欄位
[2025-06-11T03:56:34.280Z] [INFO ] 選擇地點: TNLMG
[2025-06-11T03:56:34.285Z] [INFO ] 成功使用 select 方法選擇地點: TNLMG (value=518ee0c2-a787-40a6-bb94-5a081250e896)
[2025-06-11T03:56:34.764Z] [INFO ] 截圖已保存: screenshots/after_location_selection_1749614194586.png
[2025-06-11T03:56:34.764Z] [INFO ] 表單填寫完成
[2025-06-11T03:56:34.764Z] [INFO ] 準備送簽表單
[2025-06-11T03:56:34.781Z] [INFO ] 點擊送簽按鈕
[2025-06-11T03:56:34.781Z] [INFO ] 處理送簽結果...
[2025-06-11T03:56:37.786Z] [INFO ] 無確認對話框需要處理
[2025-06-11T03:56:39.789Z] [INFO ] 表單分頁仍開啟，檢查是否有提示訊息...
[2025-06-11T03:56:40.792Z] [INFO ] 送簽完成，無特殊提示
[2025-06-11T03:56:40.793Z] [OK   ] 表單送簽完成
[2025-06-11T03:56:40.973Z] [INFO ] 表單分頁已關閉
[2025-06-11T03:56:40.980Z] [INFO ] 已切換回表單申請頁面 | Context: {
  "url": "https://flow.mayohr.com/GAIA/bpm/applyform?moduleType=apply&companyCode=TNLMG&muid=b154c3d6-7337-4af6-aff2-49cf849cde9b"
}
[2025-06-11T03:56:40.980Z] [OK   ] 任務 2025/06/10 下班打卡 完成
[2025-06-11T03:56:40.981Z] [INFO ] [2/9] 處理任務: 2025/06/09 上班打卡
[2025-06-11T03:56:40.981Z] [INFO ] 檢查當前頁面 | Context: {
  "url": "https://flow.mayohr.com/GAIA/bpm/applyform?moduleType=apply&companyCode=TNLMG&muid=b154c3d6-7337-4af6-aff2-49cf849cde9b"
}
[2025-06-11T03:56:41.982Z] [INFO ] 尋找忘打卡申請單連結...
[2025-06-11T03:56:42.011Z] [INFO ] 成功點擊忘打卡申請單連結
[2025-06-11T03:56:47.533Z] [ERROR] 任務 2025/06/09 上班打卡 失敗: 等待新分頁開啟超時
[2025-06-11T03:56:47.534Z] [ERROR] 程式執行失敗: 等待新分頁開啟超時
[2025-06-11T03:56:47.535Z] [ERROR] 錯誤堆疊 | Context: {
  "stack": "Error: 等待新分頁開啟超時\n    at IntegratedAutoAttendanceSystemV2.waitForNewPageAndSwitch (/Users/tnl-loso/Desktop/auto-re-check/dist/integrated-main-v2.js:544:15)\n    at async IntegratedAutoAttendanceSystemV2.processSingleAttendanceTask (/Users/tnl-loso/Desktop/auto-re-check/dist/integrated-main-v2.js:407:25)\n    at async IntegratedAutoAttendanceSystemV2.processAllAttendanceTasks (/Users/tnl-loso/Desktop/auto-re-check/dist/integrated-main-v2.js:391:17)\n    at async IntegratedAutoAttendanceSystemV2.run (/Users/tnl-loso/Desktop/auto-re-check/dist/integrated-main-v2.js:865:13)\n    at async main (/Users/tnl-loso/Desktop/auto-re-check/dist/integrated-main-v2.js:895:9)"
}
[2025-06-11T03:56:47.640Z] [INFO ] 瀏覽器已關閉
